(()=>{"use strict";async function e(e,o){const t=e,a=JSON.stringify(o);console.log(`%cPOST 요청: ${t}`,"color: #296aba;"),console.log(`%cPOST 요청 데이터: ${a}`,"color: #296aba;");const n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:a});if(!n.ok){const e=await n.json(),{reason:o}=e;throw new Error(o)}return await n.json()}const o=e=>{const o=e.split(" "),t=document.querySelector("#navbar"),a=!!localStorage.getItem("token"),n=!!localStorage.getItem("admin"),c={register:'<li><a href="/register">회원가입</a></li>',login:'<li><a href="/login">로그인</a></li>'},r={account:'<li><a href="/account">계정관리</a></li>',logout:'<li><a href="#" id="logout">로그아웃</a></li>',productAdd:'<li><a href="/product/add">제품 추가</a></li>',categoryAdd:'<li><a href="/category/add">카테고리 추가</a></li>'},l={admin:'<li><a href="/admin">페이지관리</a></li>'},i=document.createElement("script");i.innerText="\n      const logoutElem = document.querySelector('#logout'); \n      \n      if (logoutElem) {\n        logoutElem.addEventListener('click', () => {\n          localStorage.removeItem('token');\n          localStorage.removeItem('admin');\n\n          window.location.href = '/';\n        });\n      }\n  ";let s="";for(const e of o)n&&(s+=l[e]??""),s+=a?r[e]??"":c[e]??"";t.insertAdjacentHTML("afterbegin",s),t.after(i)},t=document.querySelector("#fullNameInput"),a=document.querySelector("#emailInput"),n=document.querySelector("#passwordInput"),c=document.querySelector("#passwordConfirmInput"),r=document.querySelector("#submitButton"),l=(document.querySelector("#googleRegisterButton"),document.querySelector("#kakaoRegisterButton"));async function i(o){o.preventDefault();const r=t.value,l=a.value,i=n.value,s=c.value,u=r.length>=2,d=(e=>String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/))(l),g=i.length>=4,m=i===s;if(!u||!g)return alert("이름은 2글자 이상, 비밀번호는 4글자 이상이어야 합니다.");if(!d)return alert("이메일 형식이 맞지 않습니다.");if(!m)return alert("비밀번호가 일치하지 않습니다.");try{const o={fullName:r,email:l,password:i};await e("/api/register",o),alert("정상적으로 회원가입되었습니다."),window.location.href="/login"}catch(e){console.error(e.stack),alert(`문제가 발생하였습니다. 확인 후 다시 시도해 주세요: ${e.message}`)}}function s(){Kakao.API.request({url:"/v2/user/me",data:{property_keys:["kakao_account.email","kakao_account.profile"]},success:u,fail:e=>console.log(e)})}async function u(o){const{email:t,profile:a}=o.kakao_account,{nickname:n}=a;try{const o={nickname:n,email:t};await e("/api/register/kakao",o),alert("정상적으로 회원가입되었습니다."),window.location.href="/login"}catch(e){console.error(e.stack),alert(`문제가 발생하였습니다. 확인 후 다시 시도해 주세요: ${e.message}`)}}!async function(){(()=>{switch(window.location.pathname){case"/":case"/cart/":case"/product/detail/":case"/product/list/":o("admin register login account logout");break;case"/account/orders/":case"/account/security/":case"/account/signout/":case"/admin/orders/":case"/admin/users/":case"/order/complete/":case"/order/":case"/product/add/":o("admin account logout");break;case"/account/":o("admin logout");break;case"/admin/":o("account logout");break;case"/category/add/":o("admin account productAdd logout");break;case"/login/":o("register");break;case"/register/":o("login")}})(),Kakao.init("b1fa466bef2a7006e303f09b63eb990c"),l.addEventListener("click",(e=>{e.preventDefault(),Kakao.Auth.login({success:s,fail:e=>console.log(e)})}))}(),r.addEventListener("click",i)})();