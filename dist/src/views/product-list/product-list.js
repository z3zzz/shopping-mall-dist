(()=>{"use strict";const e="kwang-shopping";AWS.config.update({region:"ap-northeast-2",credentials:new AWS.CognitoIdentityCredentials({IdentityPoolId:"ap-northeast-2:b6a1fa02-993d-437d-9ed5-7134db218241"})});const t=new AWS.S3({apiVersion:"2006-03-01",params:{Bucket:e}});const a=()=>{const e=window.location.search,t=new URLSearchParams(e),a={};for(const[e,n]of t)a[e]=n;return a},n=e=>{const t=e.split(" "),a=document.querySelector("#navbar"),n=!!localStorage.getItem("token"),o=!!localStorage.getItem("admin"),c={register:'<li><a href="/register">회원가입</a></li>',login:'<li><a href="/login">로그인</a></li>'},r={account:'<li><a href="/account">계정관리</a></li>',logout:'<li><a href="#" id="logout">로그아웃</a></li>',productAdd:'<li><a href="/product/add">제품 추가</a></li>',categoryAdd:'<li><a href="/category/add">카테고리 추가</a></li>'},i={admin:'<li><a href="/admin">페이지관리</a></li>'},s=document.createElement("script");s.innerText="\n      const logoutElem = document.querySelector('#logout'); \n      \n      if (logoutElem) {\n        logoutElem.addEventListener('click', () => {\n          localStorage.removeItem('token');\n          localStorage.removeItem('admin');\n\n          window.location.href = '/';\n        });\n      }\n  ";let d="";for(const e of t)o&&(d+=i[e]??""),d+=n?r[e]??"":c[e]??"";a.insertAdjacentHTML("afterbegin",d),a.after(s)},o=document.querySelector("#producItemContainer");(e=>{const{[e]:t}=a();t||window.location.replace("/page-not-found")})("category"),(()=>{switch(window.location.pathname){case"/":case"/cart/":case"/product/detail/":case"/product/list/":n("admin register login account logout");break;case"/account/orders/":case"/account/security/":case"/account/signout/":case"/admin/orders/":case"/admin/users/":case"/order/complete/":case"/order/":case"/product/add/":n("admin account logout");break;case"/account/":n("admin logout");break;case"/admin/":n("account logout");break;case"/category/add/":n("admin account productAdd logout");break;case"/login/":n("register");break;case"/register/":n("login")}})(),async function(){const{category:n}=a();(await async function(e,t=""){const a=`${e}/${t}`;console.log(`%cGET 요청: ${a} `,"color: #a25cd1;");const n=await fetch(a,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!n.ok){const e=await n.json(),{reason:t}=e;throw new Error(t)}return await n.json()}(`/api/productlist/category/${n}`)).forEach((async a=>{const{_id:n,title:c,shortDescription:r,imageKey:i,isRecommended:s,price:d}=a,l=await function(a){return new Promise((n=>{const o={Bucket:e,Key:a,Expires:60};t.getSignedUrl("getObject",o,((e,t)=>{n(t)}))}))}(i),u=Math.random().toString(36).substring(2,7);var g,m;o.insertAdjacentHTML("beforeend",`\n      <div class="message media product-item" id="a${u}">\n        <div class="media-left">\n          <figure class="image">\n            <img\n              src="${l}"\n              alt="제품 이미지"\n            />\n          </figure>\n        </div>\n        <div class="media-content">\n          <div class="content">\n            <p class="title">\n              ${c}\n              ${s?'<span class="tag is-success is-rounded">추천</span>':""}\n            </p>\n            <p class="description">${r}</p>\n            <p class="price">${g=d,g.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}원</p>\n          </div>\n        </div>\n      </div>\n      `),document.querySelector(`#a${u}`).addEventListener("click",(m=`/product/detail?id=${n}`,function(){window.location.href=m}))}))}()})();